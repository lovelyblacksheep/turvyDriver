import { StatusBar } from 'expo-status-bar';
import React from "react";
import { StyleSheet, Text, View ,Image,TouchableOpacity} from 'react-native';
import { LinearGradient } from 'expo-linear-gradient';
import {  Provider as PaperProvider,Button } from 'react-native-paper';
//import * as Permissions from 'expo-permissions';
import * as Location from 'expo-location';
import { theme, DOMAIN} from '../Riders/Constant';
import { Col, Row, Grid } from "react-native-easy-grid";
const imagemarker = require('../assets/map-pin.png');

export default class LocationEnableScreen extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
        	step:1,
    };
    //console.log(this.props);
   }
    componentDidMount(){
    	const {navigation} = this.props;
   	this.intialLoad();
  		this.unsubscribe =  navigation.addListener("focus",() => {
  			this.intialLoad();
  		});			
    }
    
    async intialLoad() {
	 const res = await Location.hasServicesEnabledAsync();
       if(!res){
       	//alert("No location");
       } else{
       	//alert("IN ELSE ");
       	this.props.navigation.replace('BookMain');
       }
 	}
 	
 	UNSAFE_componentWillUnmount() {
      this.unsubscribe();
    
  }
 	
 	async allowAccess() {
          await Location.enableNetworkProviderAsync() .then(() => {
              //setLocationStatus('accepted');
              //alert("accepted");
              this.props.navigation.replace('BookMain')
            })
            .catch(() => {
              //setLocationStatus('rejected');
              alert("rejected");
            });
      
   }

  render() {
  	 return (
  	<PaperProvider theme={theme}>
  	  <View style={{flex:1}}>
	    </View>
	    <View style={{flex:2,justifyContent:'center',alignContent:'center',flexDirection:'row'}}>
	    	<Grid style={{justifyContent:'center',alignContent:'center',width:'100%'}}>
   			<Row style={{height:260}} >
   			<Col size={12} style={{ alignItems: 'center' }} >
   			<Image
			       source={imagemarker}
			        style={styles.servicebocimage}
			         />
   			</Col>
   			</Row>
   			<Row>
   			<Col style={{ alignItems: 'center' }}>
   				<Text style={{alignItems:'center',fontSize:30,fontWeight:'bold'}}>Enable Location</Text>
   			</Col>
   			</Row>
   			<Row>
   			<Col style={{ alignItems: 'center' }}>
   				<Text style={{alignItems:'center',fontSize:12,fontWeight:'bold'}}>Choose your location to start find the request.</Text>
   			</Col>
   			</Row>
   		</Grid>
	    </View>
	    <View style={{flex:1}}>
	    	<Grid>
	    		<Row>
	    			<Col size={1}>
	    			</Col>
	    			<Col size={10}>
	    				
        				<TouchableOpacity style={styles.contentBtn} onPress={()=> this.allowAccess()}>
			        	<LinearGradient  
			        		style={styles.priBtn}       
	        				colors={['#135aa8', '#46a5dd']}
	        				end={{ x: 1.2, y: 1 }}>				        
					        	<Text style={styles.priBtnTxt}> Allow Access</Text>
				        </LinearGradient>
			        </TouchableOpacity>    
	    			</Col>
	    			<Col size={1}>
	    			</Col>
	    		</Row>
	    	</Grid>
	    </View>
	    </PaperProvider>
	  );
   }
}

const styles = StyleSheet.create({
  servicebocimage: {
    justifyContent: 'center',
    alignItems: 'center',
  },
  labelstyle:{    
    fontSize:16,    
    textAlign:'left',
    marginTop:10,
    fontFamily: 'WuerthBook'
  },
  inputstyle:{
    color:'black',
    borderBottomColor:'#D9D5DC',
    borderBottomWidth:1,
    paddingBottom: 11,
    fontSize:16,
    fontFamily: 'WuerthBook'
  },
  bgImage: {
        resizeMode: "cover",
        justifyContent: "center",
        height:170,
    },
    text: {    
        color: "white",
        fontSize: 25,    
        textAlign: "center",         
    },
    overlay: {    
        justifyContent: "center",
        backgroundColor:'rgba(0,0,0,0.6)',
        height:170,
    },
    scItem:{
      borderRadius:50,
      borderWidth:1,
      marginTop:10,
      marginBottom:10,
      marginLeft:5,
      marginRight:5,
      backgroundColor:'#FFF',      
      height:35
    },
    scText:{color:'#000',fontSize:14},
    active:{      
      backgroundColor:'#7a49a5',            
    },
    actText:{color:'#FFF'},
    boxstyle:{
    	flex:1,
    	backgroundColor:'#fff',  
    	borderRadius:10,borderWidth: 1,
    	borderColor: '#fff',
    	padding:10,margin:20,
    	shadowColor: "#000",
		shadowOffset: {
			width: 0,
			height: 2,
		},
		shadowOpacity: 0.25,
		shadowRadius: 3.84,
		elevation: 5,
    },contentBtn:{  	
  	backgroundColor:"transparent",
  	justifyContent:'center',
    alignItems:'center',
    flexDirection:'row',
  	  
  },
  priBtn:{  	  	
  	flex:1,
  	padding:15,  	
  	justifyContent:'center',
    alignItems:'center',
    borderRadius:45,    
  },
  priBtnTxt:{
  	color:'#FFF',
  	fontSize:16,
  	textTransform: 'uppercase',
  	letterSpacing: 2
  },
});
